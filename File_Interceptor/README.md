# Программа файловый перехватчик <img align="" src="https://github.com/Maxsmile123/Maxsmile123/blob/333a0368f66c4b37dfefea27ff1833aba50d7ad3/res/hacker.png" height="25px" width="25px">
Пользователь уже должен быть человеком посередине. Цель программы проста: жертва скачивает
файл определённого формата, а программа перенаправляет запрос на скачивание нашего файла, вероятно, вредоносного.
Для этого, парсим HTTP запрос и ответ. Для идентификации запроса и соответствующего его ответа, проверяем
равенства полей "ask" TCP запроса и "seq" TCP ответа. 
После, подменяем любой HTTP ответ на код 301 - Moved Permanently. Жертва перенаправляется по нашей ссылке
и скачивает её содержимое.

## Взаимодействие: 
Если вы хотите, чтобы жертва скачала что-то с вашего компьютера, то стоит запустить свой веб-сервер:
```shell
service apache2 start
iptables --flsuh
iptables -I INPUT -j NFQUEUE --queue-num 0
iptables -I OUTPUT -j NFQUEUE --queue-num 0
iptables -I FORWARD -j NFQUEUE --queue-num 0
```
При запуске программы указываются два аргумента:     
**'-t'** - формат файла, скачав который, произойдёт выполнение подмены. Указывать строчными буквами, без точки.       
**'-r'** - ссылка на файл, который в итоге скачает жертва.  

```shell
python3 file_interceptor.py -t exe -r https://www.python.org/ftp/python/3.10.0/python-3.10.0-amd64.exe
```
