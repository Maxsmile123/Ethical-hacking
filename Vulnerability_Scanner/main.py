import vulnerability_scanner as vs
import argparse



parser = argparse.ArgumentParser()
parser.add_argument("-a", "--auth", dest="auth", help="Link to authorization page")
parser.add_argument("-l", "--link", dest="link", help="Link to the site")
options = parser.parse_args()


target_url = options.link
if not target_url:
    print("[-] Input the link using -l parameter")
    exit(-1)
links_to_ignore = [""] # add path to logout file
vuln_scanner = vs.Scanner(target_url, links_to_ignore)


# The scanner should be used starting from the authorization page
# add login in "username" and password in "password"
if not options.auth:
    print("Without authorization, the scanner will find fewer links")
else:
    data_dict = {"username": "login", "password": "password"}
    res = vuln_scanner.session.post(options.auth, data=data_dict, verify=False)



vuln_scanner.crawl()
vuln_scanner.run_scanner()
